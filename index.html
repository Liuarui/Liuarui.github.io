<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="基于hexo搭建的个人博客"><meta name="keywords" content="blog,liuarui"><meta name="author" content="liuarui"><meta name="copyright" content="liuarui"><title>@lm/blog | liuarui的博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">liuarui</div><div class="author-info__description text-center">基于hexo搭建的个人博客</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/liuarui">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">30</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">22</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">liuarui的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">liuarui的博客</div><div id="site-sub-title">@lm/blog</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/31/%E8%B8%A9%E5%9D%91/ios/ios-webview%E5%9D%91/">ios rn应用中 webview 问题汇总</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-31</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E8%B8%A9%E5%9D%91/">踩坑</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/rn/">rn</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/webview/">webview</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/ios/">ios</a></span><div class="content"><h1 id="踩坑记录"><a href="#踩坑记录" class="headerlink" title="- 踩坑记录"></a>- 踩坑记录</h1><h4 id="ios-下的-webview-自带拉动到边距时自带回弹效果"><a href="#ios-下的-webview-自带拉动到边距时自带回弹效果" class="headerlink" title="- ios 下的 webview 自带拉动到边距时自带回弹效果"></a>- ios 下的 webview 自带拉动到边距时自带回弹效果</h4><p>由于自带回弹效果，在某些内部需要拖动的情况下，用户体验不好解决办法<br>在需要滚动的容器上添加 css 样式</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.xx</span> &#123;</span><br><span class="line">    <span class="attribute">overflow-x</span>: hidden; <span class="comment">// 禁止回弹设置hidden</span></span><br><span class="line">    <span class="attribute">overflow-y</span>: scroll; <span class="comment">// 需要滚动设置scroll</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/31/%E8%B8%A9%E5%9D%91/vite/vite%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8C%97/">vite踩坑指北</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-31</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E8%B8%A9%E5%9D%91/">踩坑</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/vite/">vite</a></span><div class="content"><h1 id="简单记录下，使用-vite-遇到的一些坑"><a href="#简单记录下，使用-vite-遇到的一些坑" class="headerlink" title="简单记录下，使用 vite 遇到的一些坑"></a>简单记录下，使用 vite 遇到的一些坑</h1><h3 id="1-vite-和-element-ui-一同使用的问题"><a href="#1-vite-和-element-ui-一同使用的问题" class="headerlink" title="1. vite 和 element-ui 一同使用的问题"></a>1. vite 和 element-ui 一同使用的问题</h3><p>vite 2.2.4 以上版本使用 element UI 会出现该报错<code>cannot read property &#39;$isServer&#39;</code><br>原因是因为 2.3.0 版本的 esbuild 编译 elementUI 表现不一致（说到底还是 elementUI 不支持 esModule 的问题）<br>解决方案可见该 issue: <a target="_blank" rel="noopener" href="https://github.com/vitejs/vite/issues/3370">https://github.com/vitejs/vite/issues/3370</a></p>
<pre><code>1. vite 降级为 2.2.4. vite reinstall -&gt; 2.2.4
2. 使用该插件https://www.npmjs.com/package/esbuild-plugin-vite-element-ui（但是该插件目前有坑，可见作者github）
3. 将 vue、vue-router、vuex 和 elementUI 改为 cdn 方式引入
</code></pre>
<h3 id="2-vite-plugin-vue2-插件编译-warn-级别也会抛出异常"><a href="#2-vite-plugin-vue2-插件编译-warn-级别也会抛出异常" class="headerlink" title="2. vite-plugin-vue2 插件编译 warn 级别也会抛出异常"></a>2. vite-plugin-vue2 插件编译 warn 级别也会抛出异常</h3><p>类似一些常见的 v-for 未提供 key 之类的 warn 会被 vite-plugin-vue2 认作是异常抛除，导致编译失败<br>我给作者提了 pr：<a target="_blank" rel="noopener" href="https://github.com/underfin/vite-plugin-vue2/pull/89">https://github.com/underfin/vite-plugin-vue2/pull/89</a></p>
<h3 id="3-vite，当省略文件拓展名和项目别名一起使用时会报错"><a href="#3-vite，当省略文件拓展名和项目别名一起使用时会报错" class="headerlink" title="3. vite，当省略文件拓展名和项目别名一起使用时会报错"></a>3. vite，当省略文件拓展名和项目别名一起使用时会报错</h3><p>如<code>import App from &#39;@/App&#39;</code>会报错<br><code>import App from &#39;./App&#39;</code>正常<br><code>import App from &#39;@/App.vue&#39;</code>正常<br>是一个 bug，作者已经修复，待 merge<br>解决方案和详情可见该 issue：<a target="_blank" rel="noopener" href="https://github.com/vitejs/vite/issues/3532">https://github.com/vitejs/vite/issues/3532</a></p>
<pre><code>TODO 未完待续
有一说一，vite 用起来真的爽，但是目前确实还有不少坑，不过在这飞快的热更新速度面前，不值一提！真香！
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/30/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84/">No title</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-30</time><div class="content"><p>数据结构,操作系统，计算机网络和计算机组成原理),外加编译原理和图形学以及软件工程和软件测试。</p>
<p>以上是大前端的基础课程，可以按需所取。如果不学 node，可以省去操作系统和计算机组成原理。<br>如果不用各类预编译 less 等可以不学编译原理。<br>如果不用各类 three. js 等图形框架可以不学图形学。<br>如果不用做单元测试，可以不学软件测试……</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/27/JavaScript/%E4%BD%9C%E7%94%A8%E5%9F%9F/">JavaScript之作用域</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-27</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JavaScript/">JavaScript</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E4%BD%9C%E7%94%A8%E5%9F%9F/">作用域</a></span><div class="content"><h1 id="作用域是什么？"><a href="#作用域是什么？" class="headerlink" title="作用域是什么？"></a>作用域是什么？</h1><ul>
<li><p>  作用域是程序源代码中定义变量的区域</p>
</li>
<li><p>  作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限</p>
</li>
<li><p>  JavaScript 是词法作用域</p>
</li>
</ul>
<p>执行上下文</p>
<ul>
<li>  VO</li>
<li>  作用域链</li>
<li>  this</li>
</ul>
<p>创建执行上下文有两步</p>
<ol>
<li>分析</li>
<li>执行</li>
</ol>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/CSS/%E7%A7%BB%E5%8A%A8%E7%AB%AF1px%E8%BE%B9%E6%A1%86%E9%97%AE%E9%A2%98/">移动端1px边框问题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/css/">css</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">移动端</a></span><div class="content"><ul>
<li>  使用缩放加绝对定位实现</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/JavaScript/%E5%8E%9F%E5%9E%8B/">JavaScript之原型</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JavaScript/">JavaScript</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8E%9F%E5%9E%8B/">原型</a></span><div class="content"><p>函数有一个属性 prototype,指向这个函数的原型对象</p>
<p>这个对象是 new 该函数产生的对象的原型</p>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> Person(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>p1 和 p2 的原型就是 Person.prototype</p>
<p>原型：对象创建的时候，会通过<code>__proto__</code>属性关联另一个对象，每个对象都会从原型中继承属性</p>
<p>每个原型都有一个<code>constructor</code>属性，执行关联的构造函数即<code>Person</code></p>
<p>原型链指的是，在找对象属性时，如果在当前对象找不到会顺着对象的原型去不断往上找</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E5%B7%A5%E7%A8%8B%E5%8C%96/%E8%AE%B2%E5%BA%A7%E7%AC%94%E8%AE%B0/">工程化讲座笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/">工程化</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%A4%A7%E5%89%8D%E7%AB%AF/">大前端</a></span><div class="content"><h1 id="大前端"><a href="#大前端" class="headerlink" title="大前端"></a>大前端</h1><p>不同技术栈，不能</p>
<h1 id="研发生命周期"><a href="#研发生命周期" class="headerlink" title="研发生命周期"></a>研发生命周期</h1><p>代码管理-&gt; 打包构建- &gt; CI&amp;CD -&gt; 测试 OA -&gt; 发布上线</p>
<h3 id="代码管理"><a href="#代码管理" class="headerlink" title="代码管理"></a>代码管理</h3><ul>
<li>  分支管理</li>
<li>  合并管理</li>
<li>  代码审核</li>
<li>  静态扫描</li>
</ul>
<p>gitlab<br>eslint<br>snonarQube</p>
<h3 id="打包构建"><a href="#打包构建" class="headerlink" title="打包构建"></a>打包构建</h3><ul>
<li>  依赖管理</li>
<li>  编译构建</li>
<li>  安装包加固</li>
<li>  包大小扫描</li>
</ul>
<p>webpack<br>xcode<br>android studio<br>metro</p>
<h3 id="CI-amp-CD"><a href="#CI-amp-CD" class="headerlink" title="CI&amp;CD"></a>CI&amp;CD</h3><ul>
<li>  测试环境部署</li>
<li>  APP 包体验</li>
<li>  安装包上传</li>
<li>  小程序包上传</li>
</ul>
<p>jenkins<br>docker</p>
<h3 id="测试-OA"><a href="#测试-OA" class="headerlink" title="测试 OA"></a>测试 OA</h3><ul>
<li>  单元测试</li>
<li>  Monkey 测试</li>
<li>  UI 遍历测试</li>
</ul>
<p>jest<br>Junit5<br>appium</p>
<h3 id="发布上线"><a href="#发布上线" class="headerlink" title="发布上线"></a>发布上线</h3><ul>
<li>  多渠道打包</li>
<li>  灰度发布提审</li>
<li>  生产发布提审</li>
<li>  发布管理</li>
</ul>
<p>做平台而不是做工具<br>从工具链到平台的整合<br>为了打通流程，做一个工程化平台</p>
<h3 id="工程化平台设计"><a href="#工程化平台设计" class="headerlink" title="工程化平台设计"></a>工程化平台设计</h3><ul>
<li>  支持全平台</li>
<li>  前端工程化： 提升研发效率、提升研发质量</li>
<li>  平台化：统一流程、 统一规范、统一度量</li>
</ul>
<ol>
<li>确定平台的各个模块及其范围</li>
<li>定义各个模块交付产物的标准</li>
<li>选择合适的流水线引擎</li>
<li>完善平台公共能力</li>
</ol>
<h2 id="流水线引擎设计"><a href="#流水线引擎设计" class="headerlink" title="流水线引擎设计"></a>流水线引擎设计</h2><h1 id="如何建立大前端标准化研发流程"><a href="#如何建立大前端标准化研发流程" class="headerlink" title="如何建立大前端标准化研发流程"></a>如何建立大前端标准化研发流程</h1><ol>
<li>定义各平台支付产物的标准</li>
<li>流水线统一标准化前端工作流</li>
<li>统一团队研发方式和流程</li>
</ol>
<p>统一研发规范<br>如果只是文档形式，落地难<br>使用静态代码扫描</p>
<p>工程化理解<br>从你打开编辑器敲下一次字母开始，到最终产物上线，下线的，所要经历过的一系列流程都属于工程化</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/next.js/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1/">next.js之动态路由</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/next-js/">next.js</a></span><div class="content"><h3 id="整体逻辑"><a href="#整体逻辑" class="headerlink" title="整体逻辑"></a>整体逻辑</h3><p><img src="https://www.nextjs.cn/static/images/learn/dynamic-routes/how-to-dynamic-routes.png" alt="how-to-dynamic-routes"></p>
<h3 id="getStaticPaths"><a href="#getStaticPaths" class="headerlink" title="getStaticPaths"></a>getStaticPaths</h3><ul>
<li><p>  需要使用<a target="_blank" rel="noopener" href="https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation"><code>getStaticPaths</code></a>返回一个对象，其中<code>path</code>包含动态路由所有的可能值</p>
</li>
<li><p>```js<br>  export async function getStaticPaths() {</p>
<pre><code>  const paths = getAllPostIds()
  return &#123;
      paths,
      fallback: false,
  &#125;
</code></pre>
<p>  }</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### fallback</span><br><span class="line"></span><br><span class="line">如果[`fallback`是`false`](https://www.nextjs.cn/docs/basic-features/data-fetching#fallback-false)，则任何未返回的路径[`getStaticPaths`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation)都将产生**404 页面**。</span><br><span class="line"></span><br><span class="line">如果[`fallback`为`true`](https://www.nextjs.cn/docs/basic-features/data-fetching#fallback-true)，则[`getStaticProps`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticprops-static-generation)更改行为：</span><br><span class="line"></span><br><span class="line">-   返回的路径[`getStaticPaths`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation)将在构建时呈现为 HTML。</span><br><span class="line">-   还没有在生成时生成的路径将**不会**导致 404 页。相反，Next.js 将在对此类路径的第一个请求时提供页面的“后备”版本。</span><br><span class="line">-   在后台，Next.js 将静态生成请求的路径。对同一路径的后续请求将服务于生成的页面，就像在构建时预渲染的其他页面一样。</span><br><span class="line"></span><br><span class="line">### 通配路由</span><br><span class="line"></span><br><span class="line">在文件名中使用`...`，可匹配所有具备前置路径的文件</span><br><span class="line"></span><br><span class="line">-   `pages/posts/[...id].js` matches `/posts/a`, but also `/posts/a/b`, `/posts/a/b/c` and so on.</span><br><span class="line"></span><br><span class="line">-   需要返回的匹配为数组</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">export async function getStaticPaths() &#123;</span><br><span class="line">    const paths = [</span><br><span class="line">        &#123;</span><br><span class="line">            params: &#123;</span><br><span class="line">                id: [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;],</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">    return &#123;</span><br><span class="line">        paths,</span><br><span class="line">        fallback: false,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="404page"><a href="#404page" class="headerlink" title="404page"></a>404page</h3><p>创建<code>/pages/404.js</code></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/next.js/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%A2%84%E6%B8%B2%E6%9F%93/">next.js之服务端预渲染</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/next-js/">next.js</a></span><div class="content"><p>预渲染可以带来更好的性能和 SEO。</p>
<h2 id="Ssg-静态生成：构建时生成"><a href="#Ssg-静态生成：构建时生成" class="headerlink" title="Ssg 静态生成：构建时生成"></a>Ssg 静态生成：构建时生成</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/static-generation.png" alt="static-generation"></p>
<ul>
<li><p>  静态生成不代表无需数据</p>
</li>
<li><p>  使用 getStaticProps</p>
</li>
</ul>
<h2 id="ssr-服务端渲染：使用请求然后通过请求生成-html"><a href="#ssr-服务端渲染：使用请求然后通过请求生成-html" class="headerlink" title="ssr 服务端渲染：使用请求然后通过请求生成 html"></a>ssr 服务端渲染：使用请求然后通过请求生成 html</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/server-side-rendering.png" alt="static-generation"></p>
<ul>
<li>  使用 getServerSideProps</li>
</ul>
<h2 id="csr-客户端渲染"><a href="#csr-客户端渲染" class="headerlink" title="csr 客户端渲染"></a>csr 客户端渲染</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/client-side-rendering.png" alt="client-side-rendering"></p>
<ul>
<li><p>  如果你不做需要预先渲染的数据，可使用 csr</p>
</li>
<li><p>  不需要 seo 的部分可以使用 csr</p>
</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/snion%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/Fakes/">snion中文文档 Fakes</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/snion/">snion</a></span><div class="content"><h1 id="Fakes"><a href="#Fakes" class="headerlink" title="Fakes"></a>Fakes</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li>  <code>fake</code>从 v5 版本开始可在 Sinon 中使用。</li>
<li>  fake 拥有创建具有设置默认<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/fakes/#fakes-with-behavior">行为</a>的 <code>fake Function</code> 功能。</li>
<li>  使用具有与<code>sinon.stub</code>中相同的 API 的<code>Functions</code>来设/Users/lm/Desktop/note/snion 中文文档/Fakes.md 置<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/fakes/#fakes-with-behavior">行为</a></li>
<li>  创建的具有或不具有行为的<code>fake Function</code>具有与（<code>sinon.spy</code>)<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/spies"><code>spies</code></a>相同的 API。</li>
</ul>
<p>在 <code>Sinon</code> 中，<code>fake</code> 是一个 <code>Function</code> 它记录其所有调用的参数，返回值，this 的值和引发的异常（如果有）。<br><code>fake</code>是不变的：一旦创建，行为就不会改变。</p>
<p>与 <code>sinon.spy</code> 和 <code>sinon.stub</code> 方法不同，<code>sinon.fakeAPI</code> 仅关注如何创建 fake，而与将<code>fake</code>插入被测系统无关。<br>要将<code>fake</code>插入被测系统，可以使用这些 <a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/sandbox#sandboxreplaceobject-property-replacement"><code>sinon.replace\*</code></a>方法。</p>
<h2 id="创建一个-fake"><a href="#创建一个-fake" class="headerlink" title="创建一个 fake"></a>创建一个 <code>fake</code></h2><p>创建一个有或没有行为的<code>fake Function</code>， 创建的函数都将具有与 <code>sinon.spy</code> 相同的 API。</p>
<ul>
<li>  Creating a fake without behavior</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a basic fake, with no behavior</span></span><br><span class="line"><span class="keyword">var</span> fake = sinon.fake()</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">fake.callCount</span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  Creating a fake with custom behaviour</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a fake that returns the text &quot;foo&quot;</span></span><br><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// foo</span></span><br></pre></td></tr></table></figure>

<h2 id="Fakes-的行为"><a href="#Fakes-的行为" class="headerlink" title="Fakes 的行为"></a>Fakes 的行为</h2><p>行为一旦创造，就无法改变。</p>
<h3 id="sinon-fake-returns-value"><a href="#sinon-fake-returns-value" class="headerlink" title="sinon.fake.returns(value);"></a>sinon.fake.returns(value);</h3><p>创建返回值参数的 fake。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;apple pie&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// apple pie</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-throws-value"><a href="#sinon-fake-throws-value" class="headerlink" title="sinon.fake.throws(value);"></a>sinon.fake.throws(value);</h3><p>创建一个 fake，该 fake 将使用提供的值作为 message 属性抛出 Error。</p>
<p>如果将 Error 作为 value 参数传递，则将作为抛出的值。 如果传递了任何其他值，则该值将用于引发 Error 的 message 属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.throws(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;not apple pie&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// Error: not apple pie</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-resolves-value"><a href="#sinon-fake-resolves-value" class="headerlink" title="sinon.fake.resolves(value);"></a>sinon.fake.resolves(value);</h3><p>Creates a fake that returns a resolved Promise for the passed value.</p>
<h3 id="sinon-fake-rejects-value"><a href="#sinon-fake-rejects-value" class="headerlink" title="sinon.fake.rejects(value);"></a>sinon.fake.rejects(value);</h3><p>Creates a fake that returns a rejected Promise for the passed value.<br>如果错误被作为值参数传递，那么这将是 promise 的价值。<br>如果传递了其他任何值，则该值将用于 promise 返回的 Error 的 message 属性。</p>
<h3 id="sinon-fake-yields-value1-…-valueN"><a href="#sinon-fake-yields-value1-…-valueN" class="headerlink" title="sinon.fake.yields([value1, …, valueN]);"></a>sinon.fake.yields([value1, …, valueN]);</h3><p>sinon.fake.yields takes some values, and returns a function that when being called, expects the last argument to be a callback and invokes that callback with the same previously given values. The returned function is normally used to fake a service function that takes a callback as the last argument.</p>
<p>In code example below, the ‘readFile’ function of the ‘fs’ module is replaced with a fake function created by sinon.fake.yields. When the fake function is called, it always calls the last argument it received, which is expected to be a callback, with the values that the yields function previously took.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.yields(<span class="literal">null</span>, <span class="string">&#x27;file content&#x27;</span>)</span><br><span class="line">sinon.replace(fs, <span class="string">&#x27;readFile&#x27;</span>, fake)</span><br><span class="line">fs.readFile(<span class="string">&#x27;somefile&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end of this event loop&#x27;</span>)</span><br><span class="line"><span class="comment">// file content</span></span><br><span class="line"><span class="comment">// end of this event loop</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-yieldsAsync-value1-…-valueN"><a href="#sinon-fake-yieldsAsync-value1-…-valueN" class="headerlink" title="sinon.fake.yieldsAsync([value1, …, valueN]);"></a>sinon.fake.yieldsAsync([value1, …, valueN]);</h3><p>Similar to yields, yieldsAsync also returns a function that when invoked, the function expects the last argument to be a callback and invokes that callback with the same previously given values. However, the returned function invokes that callback asynchronously rather than immediately, i.e. in the next event loop.</p>
<p>Compare the output of the code example below with the output of the code example above for yields to see the difference.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fakeAsync = sinon.fake.yieldsAsync(<span class="literal">null</span>, <span class="string">&#x27;file content&#x27;</span>)</span><br><span class="line">sinon.replace(fs, <span class="string">&#x27;readFile&#x27;</span>, fakeAsync)</span><br><span class="line">fs.readFile(<span class="string">&#x27;somefile&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end of this event loop&#x27;</span>)</span><br><span class="line"><span class="comment">// end of this event loop</span></span><br><span class="line"><span class="comment">// file content</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-func"><a href="#sinon-fake-func" class="headerlink" title="sinon.fake(func);"></a>sinon.fake(func);</h3><p>Wraps an existing Function to record all interactions, while leaving it up to the func to provide the behavior.</p>
<p>The created fake Function has the same API as a sinon.spy.</p>
<p>This is useful when complex behavior not covered by the sinon.fake.* methods is required or when wrapping an existing function or method.</p>
<h2 id="Instance-properties"><a href="#Instance-properties" class="headerlink" title="Instance properties"></a>Instance properties</h2><p>The instance properties are the same as a sinon.spy.</p>
<h3 id="f-callback"><a href="#f-callback" class="headerlink" title="f.callback"></a>f.callback</h3><p>This property is a convenience to get a reference to the last callback passed in the last to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> cb1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> cb2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, cb1)</span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, cb2)</span><br><span class="line"></span><br><span class="line">f.callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>The same convenience has been added to spy calls:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f.getCall(<span class="number">1</span>).callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">f.lastCall.callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="f-firstArg"><a href="#f-firstArg" class="headerlink" title="f.firstArg"></a>f.firstArg</h3><p>This property is a convenient way to get a reference to the first argument passed in the last call to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">f(date1, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">f(date2, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">f.firstArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="f-lastArg"><a href="#f-lastArg" class="headerlink" title="f.lastArg"></a>f.lastArg</h3><p>This property is a convenient way to get a reference to the last argument passed in the last call to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, date1)</span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, date2)</span><br><span class="line"></span><br><span class="line">f.lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>The same convenience has been added to spy calls:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f.getCall(<span class="number">0</span>).lastArg === date1</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">f.getCall(<span class="number">1</span>).lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">f.lastCall.lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="Adding-the-fake-to-the-system-under-test"><a href="#Adding-the-fake-to-the-system-under-test" class="headerlink" title="Adding the fake to the system under test"></a>Adding the fake to the system under test</h2><p>Unlike sinon.spy and sinon.stub, sinon.fake only knows about creating fakes, not about replacing properties in the system under test.</p>
<p>To replace a property, you can use the sinon.replace method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;42&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sinon.replace(<span class="built_in">console</span>, <span class="string">&#x27;log&#x27;</span>, fake)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;apple pie&#x27;</span>)</span><br><span class="line"><span class="comment">// 42</span></span><br></pre></td></tr></table></figure>

<p>When you want to restore the replaced properties, call the sinon.restore method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// restores all replaced properties set by sinon methods (replace, spy, stub)</span></span><br><span class="line">sinon.restore()</span><br></pre></td></tr></table></figure>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2021 By liuarui</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>